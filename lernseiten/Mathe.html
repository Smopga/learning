<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Mathe Pro</title>
<style>
body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: #0f1220;
    color: #fff;
    padding: 20px;
}

h1 { text-align: center; }

.panel {
    background: #1c1f3a;
    padding: 15px;
    border-radius: 14px;
    margin-bottom: 15px;
}

.options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 8px;
}

label {
    background: #2a2e5a;
    padding: 10px;
    border-radius: 10px;
    cursor: pointer;
}

label input { margin-right: 6px; }

.task { font-size: 26px; text-align: center; margin: 20px 0; }
.answer { width: 100%; padding: 12px; font-size: 18px; border-radius: 10px; border: none; }

button {
    width: 100%; margin-top: 10px; padding: 14px; font-size: 18px;
    border: none; border-radius: 12px; background: #4cafef; color: black; cursor: pointer;
}

button:hover { opacity: 0.9; }
.status { text-align: center; margin-top: 10px; font-size: 16px; }
.score { text-align: center; font-size: 18px; }

/* SHAKE EFFECT */
@keyframes shake {
    0% { transform: translateX(0); }
    20% { transform: translateX(-6px); }
    40% { transform: translateX(6px); }
    60% { transform: translateX(-6px); }
    80% { transform: translateX(6px); }
    100% { transform: translateX(0); }
}
.shake { animation: shake 0.25s; }

/* CONFETTI */
.confetti {
    position: fixed;
    width: 8px;
    height: 8px;
    top: -10px;
    animation: fall 0.25s linear forwards;
    z-index: 9999;
}
@keyframes fall { to { transform: translateY(110vh) rotate(360deg); opacity:0; } }
</style>
</head>
<body>

<h1>üßÆ Mathe Pro</h1>

<div class="panel">
    <strong>Schwierigkeit / Klassenstufe</strong>
    <select id="difficulty" class="answer">
        <option value="1">1. Klasse</option>
        <option value="2">2. Klasse</option>
        <option value="3">3. Klasse</option>
        <option value="4">4.‚Äì6. Klasse</option>
        <option value="5">7.‚Äì9. Klasse</option>
        <option value="6">10.‚Äì12. Klasse</option>
        <option value="7">Berufsschule leicht</option>
        <option value="8">Berufsschule mittel</option>
        <option value="9">Berufsschule schwer</option>
        <option value="10">Profi / komplex</option>
    </select>
</div>

<div class="panel">
    <strong>Aufgabentypen</strong>
    <div class="options">
        <label><input type="checkbox" id="add" checked> Addition</label>
        <label><input type="checkbox" id="sub" checked> Subtraktion</label>
        <label><input type="checkbox" id="mul" checked> Multiplikation</label>
        <label><input type="checkbox" id="div"> Division</label>
        <label><input type="checkbox" id="sqrt"> Wurzel</label>
        <label><input type="checkbox" id="pow"> Potenz</label>
        <label><input type="checkbox" id="brackets" checked> Klammern</label>
        <label><input type="checkbox" id="negative"> Negative Zahlen</label>
        <label><input type="checkbox" id="decimals"> Kommazahlen</label>
        <label><input type="checkbox" id="chain"> Kettenaufgabe</label>
    </div>
</div>

<div class="panel">
    <div class="task" id="task">Neue Aufgabe starten</div>
    <input id="answer" class="answer" type="number" step="any">
    <button onclick="check()">Antwort pr√ºfen</button>
    <div class="status" id="status"></div>
    <div class="score">Punkte: <span id="score">0</span></div>
</div>

<a href="../index.html" style="color:#8ab4ff">‚Üê Zur√ºck</a>

<script>
let score=0, solution=0;
function r(max){return Math.floor(Math.random()*max)+1;}
function party(){for(let i=0;i<25;i++){const c=document.createElement("div");c.className="confetti";c.style.left=Math.random()*100+"vw";c.style.background=`hsl(${Math.random()*360},80%,60%)`;c.style.animationDuration="0.25s";document.body.appendChild(c);setTimeout(()=>c.remove(),300);}}
function shakeScreen(){document.body.classList.add("shake");setTimeout(()=>document.body.classList.remove("shake"),250);}

function newTask(){
    const level = Number(difficulty.value);
    let types=[];
    if(add.checked) types.push("+");
    if(sub.checked) types.push("-");
    if(mul.checked) types.push("*");
    if(div.checked) types.push("/");
    if(pow.checked) types.push("^");
    if(types.length===0){task.textContent="Bitte mindestens einen Aufgabentyp w√§hlen"; return;}

    let expr="";
    let partCount=1;
    if(chain.checked){partCount=2+Math.floor(Math.random()*2);} // 2‚Äì3 Teilaufgaben

    for(let i=0;i<partCount;i++){
        let a,b,c;
        switch(level){
            case 1: a=r(10); b=r(10); c=r(5); break;
            case 2: a=r(20); b=r(20); c=r(10); break;
            case 3: a=r(50); b=r(50); c=r(20); break;
            case 4: a=r(100); b=r(50); c=r(30); break;
            case 5: a=r(150); b=r(100); c=r(50); break;
            case 6: a=r(200); b=r(100); c=r(50); break;
            case 7: a=r(300); b=r(150); c=r(100); break;
            case 8: a=r(400); b=r(200); c=r(150); break;
            case 9: a=r(500); b=r(200); c=r(150); break;
            case 10:a=r(1000); b=r(500); c=r(200); break;
        }

        let partExpr=`${a} ${types[Math.floor(Math.random()*types.length)]} ${b}`;
        if(brackets.checked && Math.random()>0.3){partExpr=`(${partExpr}) ${types[Math.floor(Math.random()*types.length)]} ${c}`;}
        if(sqrt.checked && Math.random()>0.5 && level>=3){const s=r(Math.min(20,a)); partExpr=`Math.sqrt(${s*s}) + ${r(10)}`;}
        if(pow.checked && Math.random()>0.6 && level>=4){const base=r(10); const exp=r(3); partExpr=`${base}**${exp} + ${r(10)}`;}
        if(negative.checked && Math.random()>0.5){partExpr="-"+partExpr;}
        if(decimals.checked && Math.random()>0.5){partExpr+= " + " + (Math.random()*10).toFixed(2);}

        if(expr===""){expr=partExpr;}else{expr+= ` ${types[Math.floor(Math.random()*types.length)]} ${partExpr}`;}
    }

    solution=Math.round(eval(expr)*100)/100;
    task.textContent=expr.replace("Math.sqrt","‚àö").replace(/\*\*/g,"^");
    status.textContent=""; answer.value="";
}

function check(){
    const user=Number(answer.value);
    if(Math.abs(user-solution)<0.01){
        score+=5; status.textContent="‚úÖ Richtig! +5"; party(); setTimeout(newTask,250);
    }else{
        score-=10; status.textContent="‚ùå Falsch! Richtige L√∂sung: "+solution; shakeScreen();
    }
    scoreSpan.textContent=score;
}

const scoreSpan=document.getElementById("score");
newTask();
</script>

</body>
</html>
